{% extends "admin/admin_base.html" %}

{% block title %}Supprimer le studio {{ studio.name }} - Oloustream Admin{% endblock %}

{% block extra_css %}
<style>
    /* ==================== DESIGN SYSTEM ==================== */
    :root {
        /* Primary Palette */
        --primary-400: #c084fc;
        --primary-500: #a855f7;
        --primary-600: #9333ea;
        --primary-700: #7e22ce;
        
        /* Accent */
        --accent-400: #22d3ee;
        --accent-500: #06b6d4;
        
        /* Danger/Error */
        --danger-400: #f87171;
        --danger-500: #ef4444;
        --danger-600: #dc2626;
        --danger-700: #b91c1c;
        
        /* Warning */
        --warning-400: #fbbf24;
        --warning-500: #f59e0b;
        --warning-600: #d97706;
        
        /* Surfaces - Dark Theme */
        --surface-900: #0a0a0b;
        --surface-850: #121215;
        --surface-800: #1a1a1f;
        --surface-750: #1f1f26;
        --surface-700: #27272f;
        --surface-600: #3f3f4a;
        --surface-500: #52525f;
        --surface-400: #71717f;
        --surface-300: #a1a1af;
        --surface-200: #d4d4df;
        --surface-100: #f4f4f8;
        
        /* Effects */
        --glow-danger: 0 0 40px rgba(239, 68, 68, 0.3);
        --glow-danger-intense: 0 0 60px rgba(239, 68, 68, 0.4);
        --shadow-elevated: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
        --shadow-card: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
        
        /* Transitions */
        --transition-fast: 0.15s ease;
        --transition-base: 0.25s ease;
        --transition-slow: 0.4s ease;
        
        /* Border Radius */
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 20px;
        --radius-2xl: 24px;
        --radius-full: 9999px;
    }

    /* ==================== PAGE WRAPPER ==================== */
    .delete-page-wrapper {
        min-height: calc(100vh - 80px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        position: relative;
        overflow: hidden;
    }

    /* Animated background gradient */
    .delete-page-wrapper::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
            circle at 30% 40%,
            rgba(239, 68, 68, 0.08) 0%,
            transparent 50%
        ),
        radial-gradient(
            circle at 70% 60%,
            rgba(168, 85, 247, 0.05) 0%,
            transparent 50%
        );
        animation: bgFloat 20s ease-in-out infinite alternate;
        pointer-events: none;
    }

    @keyframes bgFloat {
        0% { transform: translate(0, 0) rotate(0deg); }
        100% { transform: translate(-20px, -20px) rotate(3deg); }
    }

    /* ==================== MAIN CARD ==================== */
    .delete-card {
        position: relative;
        width: 100%;
        max-width: 520px;
        background: linear-gradient(
            165deg,
            var(--surface-800) 0%,
            var(--surface-850) 50%,
            var(--surface-800) 100%
        );
        border-radius: var(--radius-2xl);
        overflow: hidden;
        animation: cardAppear 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        box-shadow: var(--shadow-card),
                    0 0 0 1px rgba(239, 68, 68, 0.1),
                    inset 0 1px 0 rgba(255, 255, 255, 0.03);
    }

    @keyframes cardAppear {
        0% {
            opacity: 0;
            transform: scale(0.95) translateY(20px);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    /* Animated border glow */
    .delete-card::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: var(--radius-2xl);
        padding: 1px;
        background: linear-gradient(
            135deg,
            rgba(239, 68, 68, 0.5),
            rgba(239, 68, 68, 0.1),
            rgba(168, 85, 247, 0.2),
            rgba(239, 68, 68, 0.1),
            rgba(239, 68, 68, 0.5)
        );
        background-size: 300% 300%;
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        animation: borderGlow 4s ease infinite;
        pointer-events: none;
    }

    @keyframes borderGlow {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    /* ==================== CARD HEADER ==================== */
    .delete-card-header {
        position: relative;
        padding: 2.5rem 2rem 2rem;
        text-align: center;
        background: linear-gradient(
            180deg,
            rgba(239, 68, 68, 0.12) 0%,
            rgba(239, 68, 68, 0.03) 100%
        );
        border-bottom: 1px solid rgba(239, 68, 68, 0.1);
    }

    /* Danger Icon Container */
    .danger-icon-wrapper {
        position: relative;
        width: 88px;
        height: 88px;
        margin: 0 auto 1.5rem;
    }

    .danger-icon-bg {
        position: absolute;
        inset: 0;
        background: linear-gradient(
            135deg,
            rgba(239, 68, 68, 0.2),
            rgba(239, 68, 68, 0.05)
        );
        border-radius: var(--radius-full);
        border: 2px solid rgba(239, 68, 68, 0.3);
        animation: iconPulse 2.5s ease-in-out infinite;
    }

    @keyframes iconPulse {
        0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
        }
        50% {
            transform: scale(1.02);
            box-shadow: 0 0 0 20px rgba(239, 68, 68, 0);
        }
    }

    .danger-icon {
        position: relative;
        z-index: 1;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .danger-icon i {
        font-size: 2.5rem;
        color: var(--danger-400);
        filter: drop-shadow(0 0 10px rgba(239, 68, 68, 0.5));
        animation: iconBounce 2s ease-in-out infinite;
    }

    @keyframes iconBounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-4px); }
    }

    /* Header Text */
    .delete-card-title {
        font-size: 1.625rem;
        font-weight: 700;
        color: var(--surface-100);
        margin: 0 0 0.5rem;
        letter-spacing: -0.02em;
    }

    .delete-card-subtitle {
        font-size: 0.9375rem;
        color: var(--surface-400);
        margin: 0;
    }

    /* ==================== CARD BODY ==================== */
    .delete-card-body {
        padding: 2rem;
    }

    /* Studio Preview Card */
    .studio-preview {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.25rem;
        background: linear-gradient(
            135deg,
            var(--surface-700),
            var(--surface-750)
        );
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: var(--radius-lg);
        margin-bottom: 1.5rem;
        transition: all var(--transition-base);
        animation: slideUp 0.4s ease 0.2s backwards;
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(15px);
        }
    }

    .studio-preview:hover {
        border-color: rgba(168, 85, 247, 0.2);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.3);
    }

    .studio-preview-image {
        width: 64px;
        height: 64px;
        border-radius: var(--radius-md);
        overflow: hidden;
        flex-shrink: 0;
        position: relative;
        background: var(--surface-800);
    }

    .studio-preview-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .studio-preview-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
    }

    .studio-preview-placeholder i {
        font-size: 1.75rem;
        color: rgba(255, 255, 255, 0.9);
    }

    .studio-preview-info {
        flex: 1;
        min-width: 0;
    }

    .studio-preview-name {
        font-size: 1.0625rem;
        font-weight: 600;
        color: var(--surface-100);
        margin: 0 0 0.375rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .studio-preview-badge {
        padding: 0.1875rem 0.5rem;
        background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
        border-radius: var(--radius-full);
        font-size: 0.6875rem;
        font-weight: 700;
        color: white;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .studio-preview-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .studio-preview-meta-item {
        display: flex;
        align-items: center;
        gap: 0.375rem;
        font-size: 0.8125rem;
        color: var(--surface-400);
    }

    .studio-preview-meta-item i {
        font-size: 0.9375rem;
        color: var(--surface-500);
    }

    /* Warning Box */
    .warning-alert {
        display: flex;
        gap: 1rem;
        padding: 1.25rem;
        background: linear-gradient(
            135deg,
            rgba(245, 158, 11, 0.12),
            rgba(245, 158, 11, 0.05)
        );
        border: 1px solid rgba(245, 158, 11, 0.25);
        border-radius: var(--radius-lg);
        margin-bottom: 1.5rem;
        animation: slideUp 0.4s ease 0.3s backwards;
    }

    .warning-alert-icon {
        flex-shrink: 0;
        width: 42px;
        height: 42px;
        background: rgba(245, 158, 11, 0.15);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .warning-alert-icon i {
        font-size: 1.25rem;
        color: var(--warning-400);
    }

    .warning-alert-content {
        flex: 1;
    }

    .warning-alert-title {
        font-size: 0.9375rem;
        font-weight: 600;
        color: var(--warning-400);
        margin: 0 0 0.375rem;
    }

    .warning-alert-text {
        font-size: 0.875rem;
        color: var(--surface-300);
        margin: 0;
        line-height: 1.6;
    }

    .warning-alert-text strong {
        color: var(--danger-400);
        font-weight: 600;
    }

    /* Impact List */
    .impact-section {
        margin-bottom: 1.5rem;
        animation: slideUp 0.4s ease 0.4s backwards;
    }

    .impact-section-title {
        font-size: 0.75rem;
        font-weight: 700;
        color: var(--surface-500);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin-bottom: 0.875rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .impact-section-title::after {
        content: '';
        flex: 1;
        height: 1px;
        background: linear-gradient(90deg, var(--surface-600), transparent);
    }

    .impact-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 0.625rem;
    }

    .impact-list-item {
        display: flex;
        align-items: center;
        gap: 0.875rem;
        padding: 0.75rem 1rem;
        background: var(--surface-750);
        border: 1px solid rgba(255, 255, 255, 0.04);
        border-radius: var(--radius-md);
        transition: all var(--transition-fast);
    }

    .impact-list-item:hover {
        background: var(--surface-700);
        border-color: rgba(239, 68, 68, 0.15);
        transform: translateX(4px);
    }

    .impact-list-item i {
        font-size: 1.125rem;
        color: var(--danger-400);
        flex-shrink: 0;
    }

    .impact-list-item span {
        font-size: 0.875rem;
        color: var(--surface-200);
    }

    /* Confirmation Box */
    .confirm-section {
        margin-bottom: 1.75rem;
        animation: slideUp 0.4s ease 0.5s backwards;
    }

    .confirm-checkbox-wrapper {
        display: flex;
        align-items: flex-start;
        gap: 0.875rem;
        padding: 1.125rem 1.25rem;
        background: linear-gradient(
            135deg,
            rgba(239, 68, 68, 0.08),
            rgba(239, 68, 68, 0.03)
        );
        border: 1px solid rgba(239, 68, 68, 0.2);
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-base);
    }

    .confirm-checkbox-wrapper:hover {
        background: linear-gradient(
            135deg,
            rgba(239, 68, 68, 0.12),
            rgba(239, 68, 68, 0.05)
        );
        border-color: rgba(239, 68, 68, 0.3);
    }

    .confirm-checkbox-wrapper.checked {
        background: linear-gradient(
            135deg,
            rgba(239, 68, 68, 0.15),
            rgba(239, 68, 68, 0.08)
        );
        border-color: rgba(239, 68, 68, 0.4);
    }

    /* Custom Checkbox */
    .custom-checkbox {
        position: relative;
        width: 24px;
        height: 24px;
        flex-shrink: 0;
        margin-top: 0.125rem;
    }

    .custom-checkbox input {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        width: 100%;
        height: 100%;
        z-index: 2;
    }

    .checkbox-visual {
        position: absolute;
        inset: 0;
        background: var(--surface-700);
        border: 2px solid var(--surface-500);
        border-radius: 6px;
        transition: all var(--transition-fast);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .checkbox-visual i {
        font-size: 0.875rem;
        color: white;
        opacity: 0;
        transform: scale(0.5);
        transition: all var(--transition-fast);
    }

    .custom-checkbox input:checked ~ .checkbox-visual {
        background: linear-gradient(135deg, var(--danger-500), var(--danger-600));
        border-color: var(--danger-500);
        box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
    }

    .custom-checkbox input:checked ~ .checkbox-visual i {
        opacity: 1;
        transform: scale(1);
    }

    .custom-checkbox input:focus ~ .checkbox-visual {
        box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2);
    }

    .confirm-checkbox-text {
        font-size: 0.9375rem;
        color: var(--surface-300);
        line-height: 1.6;
    }

    .confirm-checkbox-text strong {
        color: var(--danger-400);
        font-weight: 600;
    }

    /* ==================== ACTION BUTTONS ==================== */
    .actions-container {
        display: flex;
        gap: 0.875rem;
        animation: slideUp 0.4s ease 0.6s backwards;
    }

    .btn-action {
        flex: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.625rem;
        padding: 1rem 1.5rem;
        font-size: 0.9375rem;
        font-weight: 600;
        font-family: inherit;
        border: none;
        border-radius: var(--radius-lg);
        cursor: pointer;
        text-decoration: none;
        transition: all var(--transition-base);
        position: relative;
        overflow: hidden;
    }

    .btn-action i {
        font-size: 1.125rem;
        transition: transform var(--transition-fast);
    }

    /* Cancel Button */
    .btn-cancel {
        background: var(--surface-700);
        color: var(--surface-200);
        border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .btn-cancel:hover {
        background: var(--surface-600);
        color: var(--surface-100);
        border-color: rgba(255, 255, 255, 0.12);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px -5px rgba(0, 0, 0, 0.3);
    }

    .btn-cancel:hover i {
        transform: rotate(-90deg);
    }

    /* Delete Button */
    .btn-delete {
        background: linear-gradient(135deg, var(--danger-500), var(--danger-600));
        color: white;
        box-shadow: 0 4px 15px rgba(239, 68, 68, 0.35),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .btn-delete::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(
            135deg,
            rgba(255, 255, 255, 0.2),
            transparent 50%
        );
        opacity: 0;
        transition: opacity var(--transition-fast);
    }

    .btn-delete:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(239, 68, 68, 0.45),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    .btn-delete:hover::before {
        opacity: 1;
    }

    .btn-delete:hover i {
        transform: translateX(3px);
    }

    .btn-delete:active {
        transform: translateY(0);
    }

    /* Disabled State */
    .btn-delete:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
        box-shadow: none !important;
    }

    .btn-delete:disabled::before {
        display: none;
    }

    /* Loading State */
    .btn-delete.loading {
        pointer-events: none;
    }

    .btn-delete.loading .btn-text {
        opacity: 0;
    }

    .btn-delete.loading::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    /* ==================== CARD FOOTER ==================== */
    .delete-card-footer {
        padding: 1rem 2rem;
        background: rgba(0, 0, 0, 0.25);
        border-top: 1px solid rgba(255, 255, 255, 0.04);
    }

    .footer-note {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        font-size: 0.8125rem;
        color: var(--surface-500);
        margin: 0;
    }

    .footer-note i {
        font-size: 1rem;
        color: var(--surface-400);
    }

    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 576px) {
        .delete-page-wrapper {
            padding: 1rem;
            align-items: flex-start;
            padding-top: 1.5rem;
        }

        .delete-card {
            border-radius: var(--radius-xl);
        }

        .delete-card-header {
            padding: 2rem 1.5rem 1.5rem;
        }

        .danger-icon-wrapper {
            width: 72px;
            height: 72px;
        }

        .danger-icon i {
            font-size: 2rem;
        }

        .delete-card-title {
            font-size: 1.375rem;
        }

        .delete-card-body {
            padding: 1.5rem;
        }

        .studio-preview {
            flex-direction: column;
            text-align: center;
            gap: 0.875rem;
        }

        .studio-preview-meta {
            justify-content: center;
        }

        .warning-alert {
            flex-direction: column;
            text-align: center;
            gap: 0.875rem;
        }

        .warning-alert-icon {
            align-self: center;
        }

        .actions-container {
            flex-direction: column-reverse;
        }

        .btn-action {
            width: 100%;
        }
    }

    /* ==================== ANIMATIONS ==================== */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="delete-page-wrapper">
    <div class="delete-card">
        <!-- ========== HEADER ========== -->
        <div class="delete-card-header">
            <div class="danger-icon-wrapper">
                <div class="danger-icon-bg"></div>
                <div class="danger-icon">
                    <i class="ph ph-warning-circle"></i>
                </div>
            </div>
            <h1 class="delete-card-title">Supprimer ce studio ?</h1>
            <p class="delete-card-subtitle">Cette action est définitive et irréversible</p>
        </div>

        <!-- ========== BODY ========== -->
        <div class="delete-card-body">
            <!-- Studio Preview -->
            <div class="studio-preview">
                <div class="studio-preview-image">
                    {% if studio.image %}
                        <img src="{{ studio.image.url }}" alt="{{ studio.name }}">
                    {% else %}
                        <div class="studio-preview-placeholder">
                            <i class="ph ph-video-camera"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="studio-preview-info">
                    <h3 class="studio-preview-name">
                        {{ studio.name }}
                        {% if studio.is_active %}
                            <span class="studio-preview-badge">Actif</span>
                        {% endif %}
                    </h3>
                    <div class="studio-preview-meta">
                        <span class="studio-preview-meta-item">
                            <i class="ph ph-identification-card"></i>
                            ID: {{ studio.pk }}
                        </span>
                        {% if studio.capacity %}
                        <span class="studio-preview-meta-item">
                            <i class="ph ph-users"></i>
                            {{ studio.capacity }} places
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Warning Alert -->
            <div class="warning-alert">
                <div class="warning-alert-icon">
                    <i class="ph ph-warning"></i>
                </div>
                <div class="warning-alert-content">
                    <h4 class="warning-alert-title">Attention importante</h4>
                    <p class="warning-alert-text">
                        Cette action est <strong>irréversible</strong>. Les réservations existantes 
                        seront conservées mais ne seront plus associées à ce studio.
                    </p>
                </div>
            </div>

            <!-- Impact Section -->
            <div class="impact-section">
                <h4 class="impact-section-title">Impact de la suppression</h4>
                <ul class="impact-list">
                    <li class="impact-list-item">
                        <i class="ph ph-video-camera-slash"></i>
                        <span>Les informations du studio seront perdues</span>
                    </li>
                    <li class="impact-list-item">
                        <i class="ph ph-calendar-x"></i>
                        <span>Les réservations ne seront plus liées au studio</span>
                    </li>
                    <li class="impact-list-item">
                        <i class="ph ph-images"></i>
                        <span>Les médias associés seront supprimés</span>
                    </li>
                    <li class="impact-list-item">
                        <i class="ph ph-chart-line-down"></i>
                        <span>Les statistiques ne seront plus accessibles</span>
                    </li>
                </ul>
            </div>

            <!-- Confirmation Form -->
            <form method="post" id="deleteForm">
                {% csrf_token %}
                
                <div class="confirm-section">
                    <label class="confirm-checkbox-wrapper" id="checkboxWrapper">
                        <div class="custom-checkbox">
                            <input type="checkbox" id="confirmDelete" required>
                            <div class="checkbox-visual">
                                <i class="ph ph-check-bold"></i>
                            </div>
                        </div>
                        <span class="confirm-checkbox-text">
                            Je confirme vouloir supprimer définitivement le studio 
                            <strong>{{ studio.name }}</strong> et comprends que cette action 
                            ne peut pas être annulée.
                        </span>
                    </label>
                </div>

                <!-- Actions -->
                <div class="actions-container">
                    <a href="{% url 'dashboard:studios_detail' studio.pk %}" class="btn-action btn-cancel">
                        <i class="ph ph-arrow-left"></i>
                        <span>Annuler</span>
                    </a>
                    <button type="submit" class="btn-action btn-delete" id="deleteBtn" disabled>
                        <i class="ph ph-trash"></i>
                        <span class="btn-text">Supprimer définitivement</span>
                    </button>
                </div>
            </form>
        </div>

        <!-- ========== FOOTER ========== -->
        <div class="delete-card-footer">
            <p class="footer-note">
                <i class="ph ph-shield-warning"></i>
                Cette opération sera enregistrée dans l'historique
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const checkbox = document.getElementById('confirmDelete');
    const checkboxWrapper = document.getElementById('checkboxWrapper');
    const deleteBtn = document.getElementById('deleteBtn');
    const form = document.getElementById('deleteForm');

    // Toggle checkbox visual state
    function updateCheckboxState() {
        if (checkbox.checked) {
            checkboxWrapper.classList.add('checked');
            deleteBtn.disabled = false;
        } else {
            checkboxWrapper.classList.remove('checked');
            deleteBtn.disabled = true;
        }
    }

    checkbox.addEventListener('change', updateCheckboxState);

    // Form submission
    form.addEventListener('submit', function(e) {
        if (!checkbox.checked) {
            e.preventDefault();
            return false;
        }

        // Add loading state
        deleteBtn.classList.add('loading');
        deleteBtn.disabled = true;
    });

    // Keyboard accessibility
    checkboxWrapper.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            checkbox.checked = !checkbox.checked;
            updateCheckboxState();
        }
    });

    // Add ripple effect on button click
    document.querySelectorAll('.btn-action').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (this.disabled) return;
            
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${e.clientX - rect.left - size/2}px;
                top: ${e.clientY - rect.top - size/2}px;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                transform: scale(0);
                animation: ripple 0.6s ease-out;
                pointer-events: none;
            `;
            
            this.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        });
    });

    // Add ripple animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes ripple {
            to {
                transform: scale(2.5);
                opacity: 0;
            }
        }
    `;
    document.head.appendChild(style);
});
</script>
{% endblock %}