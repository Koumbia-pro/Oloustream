{# templates/user/studios/list.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}Studios - Oloustream{% endblock %}

{% block content %}

<style>
:root {
    --red: #E60000;
    --red-dark: #CC0000;
    --gold: #F59E0B;
    --black: #000000;
    --dark: #020617;
    --gray-200: #E5E7EB;
    --gray-400: #9CA3AF;
    --white: #FFFFFF;
    
    /* D√©riv√©es pour am√©liorer l'UX */
    --red-soft: rgba(230, 0, 0, 0.08);
    --red-glow: rgba(230, 0, 0, 0.4);
    --gold-glow: rgba(245, 158, 11, 0.45);
    --surface-elevated: #0f172a;
    --border-subtle: #1e293b;
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;
    --text-muted: #64748b;
    
    /* Espacements et transitions */
    --radius-lg: 1.25rem;
    --radius-md: 0.875rem;
    --radius-pill: 9999px;
    --shadow-strong: 0 20px 45px rgba(0, 0, 0, 0.5);
    --shadow-medium: 0 12px 28px rgba(0, 0, 0, 0.35);
    --shadow-soft: 0 8px 20px rgba(0, 0, 0, 0.25);
    --transition-fast: 160ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-medium: 220ms cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    box-sizing: border-box;
}

/* ==================== PAGE WRAPPER ==================== */
.studios-page {
    margin-bottom: 3rem;
    font-size: 0.9375rem;
    line-height: 1.6;
}

/* ==================== TABS NAVIGATION ==================== */
.studios-tabs {
    background: linear-gradient(145deg, var(--dark) 0%, var(--surface-elevated) 100%);
    border-radius: var(--radius-lg);
    padding: 0.625rem;
    display: flex;
    gap: 0.625rem;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-strong);
    border: 1px solid var(--border-subtle);
    position: relative;
    overflow: hidden;
}

/* Effet de brillance subtile */
.studios-tabs::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(230, 0, 0, 0.05), transparent);
    animation: shimmer 8s infinite;
    pointer-events: none;
}

@keyframes shimmer {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}

.studios-tab {
    flex: 1;
    position: relative;
    border-radius: var(--radius-md);
    border: 1px solid transparent;
    padding: 0.75rem 1rem;
    background: rgba(15, 23, 42, 0.6);
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 0.8125rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.375rem;
    white-space: nowrap;
    transition: all var(--transition-medium);
    overflow: hidden;
}

/* √âtat hover */
.studios-tab:hover:not(.active) {
    background: var(--surface-elevated);
    border-color: rgba(100, 116, 139, 0.3);
    color: var(--text-primary);
    transform: translateY(-2px);
}

/* √âtat actif */
.studios-tab.active {
    background: linear-gradient(135deg, var(--red) 0%, var(--red-dark) 100%);
    color: var(--white);
    border-color: var(--red-dark);
    transform: translateY(-3px);
    box-shadow: 0 12px 28px var(--red-glow), 
                0 0 0 1px rgba(230, 0, 0, 0.2) inset;
}

/* Animation de pulsation subtile sur l'onglet actif */
.studios-tab.active::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(circle at center, rgba(255, 255, 255, 0.15), transparent 70%);
    opacity: 0;
    animation: pulse 2.5s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 0; }
    50% { opacity: 1; }
}

/* Focus visible (accessibilit√©) */
.studios-tab:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--dark),
                0 0 0 4px var(--red),
                var(--shadow-medium);
}

/* ==================== FILTERS BAR ==================== */
.studios-filters {
    background: linear-gradient(135deg, var(--dark) 0%, var(--surface-elevated) 100%);
    border-radius: var(--radius-lg);
    padding: 1.25rem 1.5rem;
    box-shadow: var(--shadow-strong);
    margin-bottom: 1.75rem;
    border: 1px solid var(--border-subtle);
    position: relative;
    overflow: hidden;
}

/* Accent subtil */
.studios-filters::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--red), var(--gold), transparent);
    opacity: 0.5;
}

.studios-filters label {
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.375rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    display: block;
}

.studios-filters .form-control,
.studios-filters .form-select {
    border-radius: var(--radius-pill);
    border: 1px solid var(--border-subtle);
    background: rgba(0, 0, 0, 0.3);
    color: var(--text-primary);
    font-size: 0.875rem;
    padding: 0.625rem 1.125rem;
    transition: all var(--transition-fast);
    backdrop-filter: blur(8px);
}

.studios-filters .form-control::placeholder,
.studios-filters .form-select::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
}

.studios-filters .form-control:hover,
.studios-filters .form-select:hover {
    border-color: var(--gray-400);
    background: rgba(0, 0, 0, 0.4);
}

.studios-filters .form-control:focus,
.studios-filters .form-select:focus {
    outline: none;
    border-color: var(--red);
    background: rgba(0, 0, 0, 0.5);
    box-shadow: 0 0 0 3px rgba(230, 0, 0, 0.15),
                0 8px 16px rgba(0, 0, 0, 0.2);
}

/* Bouton de recherche */
.btn-studios-search {
    border-radius: var(--radius-pill);
    background: linear-gradient(135deg, var(--red) 0%, var(--red-dark) 100%);
    border: 1px solid var(--red-dark);
    color: var(--white);
    font-weight: 700;
    padding: 0.625rem 2rem;
    font-size: 0.875rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    box-shadow: 0 10px 24px var(--red-glow);
    transition: all var(--transition-medium);
    position: relative;
    overflow: hidden;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Effet de brillance au survol */
.btn-studios-search::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width var(--transition-medium), height var(--transition-medium);
}

.btn-studios-search:hover::before {
    width: 300px;
    height: 300px;
}

.btn-studios-search:hover {
    transform: translateY(-3px);
    box-shadow: 0 16px 32px var(--red-glow);
    border-color: var(--red);
}

.btn-studios-search:active {
    transform: translateY(-1px);
    box-shadow: 0 6px 16px var(--red-glow);
}

.btn-studios-search:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--dark),
                0 0 0 4px var(--red);
}

/* ==================== STUDIO COUNT ==================== */
.studios-count {
    font-size: 0.875rem;
    margin: 1.5rem 0 1rem;
    color: var(--text-muted);
    font-weight: 500;
    letter-spacing: 0.02em;
}

/* ==================== STUDIO CARDS ==================== */
.studio-card-wrapper {
    transition: opacity var(--transition-medium);
}

.studio-card {
    border-radius: var(--radius-lg);
    background: var(--white);
    border: 1px solid var(--gray-200);
    box-shadow: var(--shadow-soft);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 100%;
    transition: all var(--transition-medium);
    position: relative;
}

.studio-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--red), var(--gold));
    transform: scaleX(0);
    transform-origin: left;
    transition: transform var(--transition-medium);
}

.studio-card:hover::before {
    transform: scaleX(1);
}

.studio-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
    border-color: var(--gray-400);
}

/* Media / Image */
.studio-card-media {
    position: relative;
    height: 200px;
    overflow: hidden;
    background: linear-gradient(135deg, var(--dark) 0%, var(--surface-elevated) 100%);
}

.studio-card-media::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.4) 100%);
    opacity: 0;
    transition: opacity var(--transition-medium);
}

.studio-card:hover .studio-card-media::after {
    opacity: 1;
}

.studio-card-media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-medium);
    filter: brightness(0.95);
}

.studio-card:hover .studio-card-media img {
    transform: scale(1.08);
    filter: brightness(1);
}

/* Card Body */
.studio-card-body {
    padding: 1.25rem 1.5rem 1.5rem;
    display: flex;
    flex-direction: column;
    flex: 1;
    background: var(--white);
}

/* Tag type de studio */
.studio-card-tag {
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--red);
    background: var(--red-soft);
    padding: 0.25rem 0.625rem;
    border-radius: 0.375rem;
    display: inline-block;
    margin-bottom: 0.625rem;
    align-self: flex-start;
}

/* Titre */
.studio-card-title {
    font-size: 1.125rem;
    font-weight: 800;
    text-transform: uppercase;
    color: var(--black);
    margin-bottom: 0.5rem;
    text-decoration: none;
    letter-spacing: 0.03em;
    line-height: 1.3;
    transition: color var(--transition-fast);
    display: block;
}

.studio-card-title:hover {
    color: var(--red);
    text-decoration: none;
}

/* Location */
.studio-card-location {
    font-size: 0.8125rem;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.375rem;
}

/* M√©tadonn√©es */
.studio-card-meta {
    font-size: 0.8125rem;
    color: #6b7280;
    margin-bottom: 1rem;
    font-weight: 500;
}

/* Footer */
.studio-card-footer {
    margin-top: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    padding-top: 1rem;
    border-top: 1px solid var(--gray-200);
}

/* Prix */
.studio-card-price {
    font-size: 1.125rem;
    font-weight: 800;
    color: var(--black);
    white-space: nowrap;
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
}

.studio-card-price small {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Bouton r√©server */
.btn-studio-reserve {
    border-radius: var(--radius-pill);
    border: 2px solid var(--gold);
    padding: 0.625rem 1.5rem;
    font-size: 0.875rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--gold) 0%, #f59e0b 100%);
    color: var(--black);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    white-space: nowrap;
    text-decoration: none;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    box-shadow: 0 8px 20px var(--gold-glow);
    transition: all var(--transition-medium);
    position: relative;
    overflow: hidden;
}

.btn-studio-reserve::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width var(--transition-medium), height var(--transition-medium);
}

.btn-studio-reserve:hover::before {
    width: 200px;
    height: 200px;
}

.btn-studio-reserve:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 28px var(--gold-glow);
    color: var(--black);
    border-color: #f59e0b;
}

.btn-studio-reserve:active {
    transform: translateY(0);
    box-shadow: 0 4px 12px var(--gold-glow);
}

.btn-studio-reserve:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--white),
                0 0 0 4px var(--gold);
}

/* ==================== RESPONSIVE ==================== */
@media (max-width: 991px) {
    .studio-card-footer {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .btn-studio-reserve {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .studios-tabs {
        padding: 0.5rem;
        gap: 0.5rem;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
        scrollbar-color: var(--red) var(--dark);
    }
    
    .studios-tabs::-webkit-scrollbar {
        height: 6px;
    }
    
    .studios-tabs::-webkit-scrollbar-track {
        background: var(--dark);
        border-radius: 3px;
    }
    
    .studios-tabs::-webkit-scrollbar-thumb {
        background: var(--red);
        border-radius: 3px;
    }

    .studios-tab {
        flex: 0 0 auto;
        min-width: 140px;
        padding: 0.625rem 0.875rem;
        font-size: 0.75rem;
    }

    .studios-filters {
        padding: 1rem;
    }
    
    .btn-studios-search {
        width: 100%;
        margin-top: 0.5rem;
    }

    .studio-card-media {
        height: 180px;
    }
    
    .studio-card-body {
        padding: 1rem 1.25rem;
    }
}

@media (max-width: 576px) {
    .studios-page {
        font-size: 0.875rem;
    }
    
    .studio-card-title {
        font-size: 1rem;
    }
    
    .studio-card-price {
        font-size: 1rem;
    }
}

/* ==================== ACCESSIBILIT√â ==================== */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* Focus visible global */
*:focus-visible {
    outline: 2px solid var(--red);
    outline-offset: 2px;
}

/* ==================== √âTATS VIDES ==================== */
.text-muted {
    color: var(--text-muted) !important;
    text-align: center;
    padding: 3rem 1rem;
    font-size: 1rem;
}
</style>

<div class="container py-4">
  <div class="studios-page">

      <div class="studios-tabs mb-3" role="tablist" aria-label="Filtrer par type de studio">
          <button type="button" class="studios-tab active" role="tab" aria-selected="true" data-type="">
              Tous
          </button>
          <button type="button" class="studios-tab" role="tab" aria-selected="false" data-type="AUDIO">
              Audio / Podcast
          </button>
          <button type="button" class="studios-tab" role="tab" aria-selected="false" data-type="VIDEO">
              Vid√©o
          </button>
          <button type="button" class="studios-tab" role="tab" aria-selected="false" data-type="PHOTO">
              Photo
          </button>
          <button type="button" class="studios-tab" role="tab" aria-selected="false" data-type="MULTI">
              Multi-usage
          </button>
      </div>

      <div class="studios-filters mb-3">
          <form id="studios-filter-form">
              <div class="row g-3 align-items-end">
                  <div class="col-md-3">
                      <label for="id_date">Date</label>
                      <input type="date" id="id_date" name="date" class="form-control" aria-label="S√©lectionner une date">
                  </div>
                  <div class="col-md-3">
                      <label for="id_time">Heure</label>
                      <input type="time" id="id_time" name="time" class="form-control" aria-label="S√©lectionner une heure">
                  </div>
                  <div class="col-md-3">
                      <label for="id_duration">Dur√©e</label>
                      <select id="id_duration" name="duration" class="form-select" aria-label="Choisir une dur√©e">
                          <option value="">Choisir‚Ä¶</option>
                          <option value="1">1 heure</option>
                          <option value="2">2 heures</option>
                          <option value="3">3 heures</option>
                          <option value="4">4 heures</option>
                          <option value="8">Journ√©e (8h)</option>
                      </select>
                  </div>
                  <div class="col-md-3 text-md-end">
                      <button type="submit" class="btn btn-studios-search mt-2 mt-md-0">
                          <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                          </svg>
                          Rechercher
                      </button>
                  </div>
              </div>
              <div class="mt-3" style="font-size:0.8125rem;color:var(--text-muted);">
                üí° Astuce : le filtrage "date/heure/dur√©e" sera utilis√© plus tard pour pr√©-remplir la r√©servation.
              </div>
          </form>
      </div>

      <p class="studios-count" id="studios-count">
          {{ studios|length }} studio{% if studios|length > 1 %}s{% endif %}
      </p>

      <div class="row g-4" id="studios-grid">
          {% for studio in studios %}
              <div class="col-md-6 col-lg-4 studio-card-wrapper" data-type="{{ studio.studio_type }}">
                  <div class="studio-card">
                      <div class="studio-card-media">
                          {% if studio.image %}
                              <img src="{{ studio.image.url }}" alt="{{ studio.name }}" loading="lazy">
                          {% else %}
                              <img src="{% static 'img/image_1.jpg' %}" alt="{{ studio.name }}" loading="lazy">
                          {% endif %}
                      </div>

                      <div class="studio-card-body">
                          <div class="studio-card-tag">
                              {{ studio.get_studio_type_display|upper }}
                          </div>

                          <a href="{% url 'studio:user_studio_detail' studio.pk %}" class="studio-card-title">
                              {{ studio.name|upper }}
                          </a>

                          <div class="studio-card-location">
                              <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                                  <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                              </svg>
                              {% if studio.city or studio.address %}
                                  {{ studio.city|default:"" }}{% if studio.city and studio.address %}, {% endif %}{{ studio.address|default:"" }}
                              {% else %}
                                  Localisation non sp√©cifi√©e
                              {% endif %}
                          </div>

                          <div class="studio-card-meta">
                              {% if studio.area_m2 %}
                                  <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true" style="display:inline-block;vertical-align:middle;margin-right:4px;">
                                      <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2z"/>
                                  </svg>
                                  {{ studio.area_m2 }} m¬≤
                              {% endif %}
                              {% if studio.capacity %}
                                  <span style="margin:0 0.5rem;color:var(--gray-400);">‚Ä¢</span>
                                  <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true" style="display:inline-block;vertical-align:middle;margin-right:4px;">
                                      <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
                                  </svg>
                                  {{ studio.capacity }} pers.
                              {% endif %}
                          </div>

                          <div class="studio-card-footer">
                              <div class="studio-card-price">
                                  {% if studio.price_per_hour %}
                                      {{ studio.price_per_hour }} FCFA
                                      <small>par heure</small>
                                  {% else %}
                                      <small>Tarif sur devis</small>
                                  {% endif %}
                              </div>

                              <a href="{% url 'studio:user_studio_reserve' studio.pk %}"
                                 class="btn-studio-reserve"
                                 aria-label="R√©server {{ studio.name }}">
                                  <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                                      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                      <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                                  </svg>
                                  R√©server
                              </a>
                          </div>
                      </div>
                  </div>
              </div>
          {% empty %}
              <div class="col-12">
                  <p class="text-muted">
                      <svg width="48" height="48" fill="currentColor" viewBox="0 0 16 16" style="display:block;margin:0 auto 1rem;">
                          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                          <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                      </svg>
                      Aucun studio n'est disponible pour le moment.
                  </p>
              </div>
          {% endfor %}
      </div>
  </div>
</div>

<script>
(function() {
    'use strict';
    
    // Attendre que le DOM soit charg√©
    document.addEventListener('DOMContentLoaded', function() {
        
        // S√©lection des √©l√©ments
        const tabs = document.querySelectorAll('.studios-tab');
        const cards = document.querySelectorAll('.studio-card-wrapper');
        const countEl = document.getElementById('studios-count');
        const filterForm = document.getElementById('studios-filter-form');
        
        /**
         * Met √† jour le compteur de studios visibles
         */
        function updateCount() {
            let visibleCount = 0;
            
            cards.forEach(function(card) {
                if (card.style.display !== 'none') {
                    visibleCount++;
                }
            });
            
            if (countEl) {
                const pluriel = visibleCount > 1 ? 's' : '';
                countEl.textContent = visibleCount + ' studio' + pluriel;
            }
        }
        
        /**
         * Gestion du filtrage par type de studio
         */
        tabs.forEach(function(tab) {
            tab.addEventListener('click', function() {
                const selectedType = tab.dataset.type || '';
                
                // Mise √† jour des √©tats actifs des onglets
                tabs.forEach(function(t) {
                    t.classList.remove('active');
                    t.setAttribute('aria-selected', 'false');
                });
                
                tab.classList.add('active');
                tab.setAttribute('aria-selected', 'true');
                
                // Filtrage des cartes
                cards.forEach(function(card) {
                    const cardType = card.dataset.type || '';
                    
                    if (!selectedType || cardType === selectedType) {
                        card.style.display = '';
                        // Animation d'apparition
                        card.style.opacity = '0';
                        setTimeout(function() {
                            card.style.opacity = '1';
                        }, 10);
                    } else {
                        card.style.display = 'none';
                    }
                });
                
                // Mise √† jour du compteur
                updateCount();
                
                // Scroll smooth vers la grille (optionnel)
                const grid = document.getElementById('studios-grid');
                if (grid && window.innerWidth < 768) {
                    setTimeout(function() {
                        grid.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }, 150);
                }
            });
            
            // Support clavier (Enter et Space)
            tab.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    tab.click();
                }
            });
        });
        
        /**
         * Gestion du formulaire de recherche
         * Pour l'instant, on emp√™che la soumission
         * Plus tard : envoi vers le serveur ou pr√©-remplissage
         */
        if (filterForm) {
            filterForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // R√©cup√©ration des valeurs
                const dateValue = document.getElementById('id_date').value;
                const timeValue = document.getElementById('id_time').value;
                const durationValue = document.getElementById('id_duration').value;
                
                // TODO: Impl√©menter la logique de filtrage/pr√©-remplissage
                console.log('Recherche:', {
                    date: dateValue,
                    time: timeValue,
                    duration: durationValue
                });
                
                // Feedback visuel temporaire
                const btn = filterForm.querySelector('.btn-studios-search');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="40" stroke-dashoffset="40"><animate attributeName="stroke-dashoffset" values="40;0" dur="0.8s" fill="freeze"/></circle></svg> Recherche...';
                btn.disabled = true;
                
                setTimeout(function() {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 1000);
            });
        }
        
        // Initialisation du compteur
        updateCount();
        
        // Gestion du lazy loading des images (fallback si pas support√© nativement)
        if ('loading' in HTMLImageElement.prototype === false) {
            const images = document.querySelectorAll('img[loading="lazy"]');
            images.forEach(function(img) {
                img.src = img.src;
            });
        }
    });
})();
</script>

{% endblock %}